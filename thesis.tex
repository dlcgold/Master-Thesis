\documentclass[a4paper,12pt, oneside]{book}

% \usepackage{fullpage}
\usepackage[italian]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{graphics}
\usepackage{amsfonts}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amstext}
\usepackage{colortbl}
\usepackage{engrec}
\usepackage{appendix}
\usepackage{multicol}
\usepackage{rotating}
\usepackage{subcaption}
\usepackage{verbatim}
\usepackage{stackengine}
\usepackage[safe,extra]{tipa}
% \usepackage{showkeys}
\usepackage{multirow}
\usepackage{hyperref}
\usepackage{microtype}
% \usepackage{fontspec}
\usepackage{enumerate}
\usepackage{braket}
\usepackage{relsize}
\usepackage{marginnote}
\usepackage{pgfplots}
\usepackage{cancel}
\usepackage{polynom}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{framed}
\usepackage{pdfpages}
\usepackage{pgfplots}
\usepackage[chapter]{algorithm}
\makeatletter
\renewcommand{\ALG@name}{Algoritmo}
\renewcommand{\listalgorithmname}{Lista degli algoritmi}
\makeatother
%\usepackage[backend=biber, backref=true, sorting=none]{biblatex}
\usepackage{fvextra}
\usepackage{csquotes}
% \usepackage{natbib}
% \usepackage{algpseudocode}
\usepackage[cache=false]{minted}
\usepackage{mathtools}
\usepackage[noend]{algpseudocode}
\usepackage{svg}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{geometry}
\usepackage{blindtext}
\usepackage{titleps}
% \makeatletter
% \long\def\@makecaption#1#2{%
%   \vskip\abovecaptionskip
%     \bfseries #1: #2\par
%   \vskip\belowcaptionskip}%
% \makeatother
% \lstset{ % General setup for the package
%     language=Perl,
%     basicstyle=\small\sffamily,
%     frame=lines,
%     tabsize=4,
%     columns=fixed,
%     showstringspaces=false,
%     showtabs=false,
%     keepspaces,
%     commentstyle=\color{red},
%     keywordstyle=\color{blue}
% }
\usepackage{tikz}\usetikzlibrary{er}\tikzset{multi  attribute /.style={attribute
    ,double  distance =1.5pt}}\tikzset{derived  attribute /.style={attribute
    ,dashed}}\tikzset{total /.style={double  distance =1.5pt}}\tikzset{every
  entity /.style={draw=orange , fill=orange!20}}\tikzset{every  attribute
  /.style={draw=MediumPurple1, fill=MediumPurple1!20}}\tikzset{every
  relationship /.style={draw=Chartreuse2,
    fill=Chartreuse2!20}}\newcommand{\key}[1]{\underline{#1}}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows,shapes,backgrounds,petri} 
\usetikzlibrary{automata,positioning}
\usetikzlibrary{matrix}
% \renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\usepackage{fancyhdr}
\pagestyle{fancy}

\fancyhead[LO,RE]{\slshape \leftmark}
% \fancyhead[CO,CE]{\slshape\rightmark}
\fancyhead[LE,RO]{\slshape\rightmark}
\fancyfoot[C]{\thepage}
% \fancyhf{}
% \fancyhead[LO,RE]{\slshape \leftmark}
% % \fancyhead[CO,CE]{\slshape\rightmark}
% \fancyhead[LE,RO]{\slshape\thepage}
% \renewcommand{\footrulewidth}{0pt}
% \fancyfoot[C]{\thepage}
% \title{Relazione}
% \fancypagestyle{plain}{% \fancyhf{} % clear all header and footer fields
% \fancyhead[RO,RE]{\thepage}%RO=right odd, RE=right even
% \renewcommand{\headrulewidth}{0pt}
% \renewcommand{\footrulewidth}{0.3pt}}

% \AtBeginDocument{%
%   \renewcommand{\thelisting}{\Alph{chapter}.\arabic{listing}}
%   % \renewcommand\thetable{\Alph{section}.\arabic{table}}
%   % \renewcommand\thefigure{\Alph{section}.\arabic{figure}}
% }
% %Automatically change the driver counter for reset:
% \makeatletter
% \g@addto@macro\appendix{%
%   \counterwithin*{listing}{section}%
% }
% \makeatother
% c C plus plus
\def\Cplusplus{C\raisebox{0.5ex}{\tiny\textbf{++}}}
\definecolor{nordred}{RGB}{191, 97, 106}
\definecolor{nordgreen}{RGB}{135, 157, 116}

\pgfplotsset{compat=1.13}

\begin{document}

% \maketitle
\newgeometry{margin=1in} 
\begin{titlepage}
  

  \noindent
  \begin{minipage}[t]{0.19\textwidth}
    \vspace{-4mm}{\includegraphics[scale=1.15]{img/logo_unimib.pdf}}
  \end{minipage}
  \begin{minipage}[t]{0.81\textwidth}
    {
      \setstretch{1.42}
      {\textsc{Università degli Studi di Milano - Bicocca}} \\
      \textbf{Scuola di Scienze} \\
      \textbf{Dipartimento di Informatica, Sistemistica e Comunicazione} \\
      \textbf{Corso di Laurea Magistrale in Informatica} \\
      \par
    }
  \end{minipage}
  
  \vspace{40mm}
  
  \begin{center}
    {\LARGE{
        \setstretch{1.2}
        \textbf{Algoritmi per la trasformata di}}}
    \vspace{1mm}
    {\LARGE{
        \setstretch{1.2}
        \textbf{Burrows-Wheeler Posizionale con}}}
    \vspace{1mm}
    {\LARGE{
        \setstretch{1.2}
        \textbf{compressione run-length}}}
    
  \end{center}
  
  \vspace{48mm}

  \noindent
  {\large \textbf{Relatore:} \textit{Prof.ssa Raffaella Rizzi}} \\

  \noindent
  {\large \textbf{Correlatore:} \textit{Dott. Yuri Pirola}}
  
  \vspace{15mm}

  \begin{flushright}
    \textbf{\large Tesi di Laurea Magistrale di:} \\
    \large{\textit{Davide Cozzi}}\\
    \large{\textit{Matricola 829827}}
  \end{flushright}
  
  \vspace{40mm}
  \begin{center}
    {\large{\bf Anno Accademico 2021-2022}}
  \end{center}

  \restoregeometry
  
\end{titlepage}
\restoregeometry
\definecolor{shadecolor}{gray}{0.80}
\setlist{leftmargin = 2cm}
\newtheorem{teorema}{Teorema}
\newtheorem{definizione}{Definizione}
\newtheorem{esempio}{Esempio}
\newtheorem{corollario}{Corollario}
\newtheorem{lemma}{Lemma}
\newtheorem{osservazione}{Osservazione}
\newtheorem{nota}{Nota}
\newtheorem{esercizio}{Esercizio}

\algdef{SE}[DOWHILE]{Do}{doWhile}{\algorithmicdo}[1]{\algorithmicwhile\ #1}
\renewcommand{\bibname}{Bibliografia e sitografia}
\renewcommand{\chaptermark}[1]{%
  \markboth{\chaptername
    \ \thechapter.\ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
\newcommand{\floor}[1]{\lfloor #1 \rfloor}

\newcommand{\MYhref}[3][blue]{\href{#2}{\color{#1}{#3}}}%
\newcommand{\hiddenchapter}[1]{
  \stepcounter{chapter*}
  \chapter*{\arabic{chapter}\hspace{1em}{#1}}
}
\newcommand\xrowht[2][0]{\addstackgap[.5\dimexpr#2\relax]{\vphantom{#1}}}
% \pagenumbering{roman}
\begin{titlepage}
  \begin{flushright}
    \textit{E pensare che\\
      mi iscrissi ad informatica\\
      per fare il sistemista!}
  \end{flushright}
\end{titlepage}
\newpage
\newpage
\thispagestyle{plain}
\begin{flushleft}
  \huge{\textbf{Abstract}}
\end{flushleft}
\vspace{10mm}
\input{include/abstract}
{
  \pagestyle{plain}
  \tableofcontents
  \cleardoublepage
}
\chapter{Introduzione}
Negli ultimi anni si è assistiti ad un cambio di paradigma nel campo della
\textit{bioinformatica}, ovvero il passaggio dallo studio della \textit{sequenza
  lineare di un singolo genoma} a quello in cui si studia un grande insieme di
genomi, provenienti da diversi individui, al fine di poter considerare anche le
\textit{variazioni} o \textit{varianti geniche}. Questo nuovo concetto è stato
nominato per la prima 
volta da Tettelin, nel 2005, con il termine \textbf{pangenoma}.\\
Grazie ai risultati ottenuti in \textit{pangenomica} si sono permessi
miglioramenti negli studi sia nel campo della \textit{biologia} che, ad esempio,
in quello della \textit{medicina personalizzata}, soprattutto grazie ai
\textbf{genome-wide association studies (\textit{GWAS})}. In tali studi si
necessita di studiare grandi collezioni di genomi al fine di poter identificare
associazioni tra \textit{varianti geniche} e la propensione ad una certa
malattia o ad un suo particolare sintomo.\\
Dando qualche dato quantitativo possiamo pensare al fatto che il genoma umano,
ad esempio prendendo come reference il \textit{GRCh38.p14}, è composto da circa
3.1 miliardi di basi, comportanti circa 59,000 geni. Inoltre, i risultati del
\textit{1000 Genome Project} hanno portato ad identificare più di 88 milioni di
varianti tra i genomi sequenziati. Tra esse si hanno, ad esempio, 84.7 milioni
di \textbf{Single Nucleotide Polymorphisms (\textit{SNPs})}, ovvero differenze
di singole basi azotate, 3.6 milioni di piccole \textbf{inserzioni/delezioni
  (\textit{indel})} di basi e circa 60,000 \textbf{varianti strutturali},
che coinvolgono più di 50 nucleotidi. Questi numeri fanno capire come, dal punto
di vista della \textit{computer science}, siano richiesti algoritmi e strutture
dati efficienti in grado di gestire quest'incredibile mole di dati, considerando
che è destinata ad aumentare nel prossimo futuro, grazie al miglioramento delle
tecnologie di sequenziamento (\textbf{Next Generation Sequencing (\textit{NGS})}
e \textbf{Third-Generation Sequencing}).\\ 
In tale ottica, sempre da un punto di vista computazionale, il
\textit{pangenoma} può essere rappresentato in molteplici modi, tramite
strutture dati che permettano di memorizzare tutte le variazioni tra i genomi
dei vari individui. Solitamente si hanno due rappresentazioni principali: una
tramite un \textit{grafo del pangenoma} e una tramite un \textit{pannello di
  aplotipi}. In entrambi i casi sono necessarie metodologie efficienti sia per
la memorizzazione della struttura dati che per le interrogazioni alla stessa. In
questa tesi si è studiata la seconda casistica, ovvero la rappresentazione
tramite \textit{pannello di aplotipi}, dove con \textbf{aplotipo} si intende
l'insieme di alleli, ovvero di varianti, che un organismo eredita da ogni
genitore. L'informazione combinata di tutti gli aplotipi in un individuo è detta
invece \textbf{genotipo}.\\
In questo contesto trova spazio, ovviamente, uno dei problemi fondamentali
della \textit{bioinformatica}, ovvero quello del \textbf{pattern
  matching}. Inizialmente tale concetto era relativo allo studio di un breve
pattern all'interno di un testo di grandi dimensioni. Ora, con l'introduzione
del \textit{pangenoma}, tale problema si è adattato alle nuove strutture
dati. Si ha, ad esempio, il caso studiato in questa tesi: il pattern matching
tra un \textit{aplotipo esterno} e un \textit{pannello di aplotipi}.\\
\textbf{MANCANO TUTTE LE CIT}\\
\textbf{MANCA CONTINUO INTRODUZIONE E STRUTTURA TESI}
\chapter{Preliminari}
In questo capitolo verranno specificate tutti i concetti fondamentali atti a
comprendere i metodi usati in questa tesi che le motivazioni della stessa. In
primis, verranno introdotte le \textit{motivazioni biologiche}, al fine di dare
uno scopo pratico agli algoritmi e alle strutture dati introdotte, per procedere
poi con un breve excursus dei fondamenti teorici presenti allo stato
dell'arte.\\
Dal punto di vista tecnico verranno quindi introdotti i \textit{bit vector} e
gli \textit{straight-line programs}, fondamentali sia per la \textit{run-length
  encoded Burrows-Wheeler Transform}. Anche quest'ultima verrà introdotta, dopo
la versione classica della trasformata, per la quale saranno necessari i
concetti di \textit{suffix array} e \textit{longest common prefix array}. Si
introdurrà fine la \textit{Positional Burrows-Wheeler Transform}, avendo che la
tesi tratta una sua versione \textit{run-length encoded}.\\
\textit{Si specifica inoltre che, con la notazione $T[i,j]$ si intende la
  sottostringa 
del testo/sequenza/riga/colonna $T$, iniziante all'indice $i$ e terminante
all'indice $j$ incluso.}

% sezione introduzione biologia
\input{include/bio}

% sezione bitvector
\input{include/bitvector}

% sezione slp
\input{include/slp}

% sezione suffix array
\input{include/sa}

% sezione BWT
\input{include/bwt}

% sezione PBWT
\input{include/pbwt}


\chapter{Metodo}
In questo capitolo verranno illustrate le metodologie usate in questa tesi,
trattando, sia dal punto di vista teorico che sperimentale, tutte le soluzioni
che hanno portato alla costruzione della \textbf{RLPBWT}.\\
Nel dettaglio,
si approfondiranno tutte le varianti della \textbf{RLPBWT} ottenute durante lo
studio, evidenziandone pro e contro



% sezione varianti RLPBWT
\input{include/var_rlpbwt}

% sezione RLPBWT naive
\input{include/naive_rlpbwt}

% sezione RLPBWT bitvectors
\input{include/bv_rlpbwt}

% sezione mapping RLPBWT
%\input{include/map_rlpbwt}

% sezione match massimali di RLPBWT naive/bitvectors
\input{include/naive_bv_matches}

% sezione RLPBWT ms
\input{include/ms_rlpbwt}

% sezione per struttura phi
\input{include/phi}


\chapter{Risultati}
\label{reschap}
Verranno ora riportati alcuni risultati sperimentali, ottenuti su pannelli
simulati, relativi all'implementazione, in \Cplusplus 11, della \textbf{RLPBWT}.
% sezione strumenti
\input{include/strumenti}
% sezione benchmark
%\input{include/bench}

% sezione complessità
\input{include/compl}


\chapter{Conclusioni}
Fissato l'iniziale obbiettivo di risolvere le problematiche relative alla
memoria richiesta dall'algoritmo 5 di Durbin, l'implementazione della
\textbf{RLPBWT}, nel dettaglio basata sull'uso dei \textit{SLP} e \textit{LCE
  query}, ha riportato risultati molto incoraggianti. Come descritto nel
capitolo \ref{reschap}, la quantità di memoria richiesta risulta essere
incredibilmente inferiore. D'altro canto l'algoritmo \textit{matchDynamic} di
Durbin, per quanto non approfondito nell'articolo del 2014 \cite{pbwt}, risulta
essere ancor meno esoso di risorse, nonché incredibilmente più veloce dal punto
di vista dei tempi di calcolo. Lo svantaggio di questo algoritmo è che i
risultati sono prodotti in ``ordine sparso'' e, giudicando la letteratura degli
ultimi anni le cui trattazioni si basano sempre sull'algoritmo 5, che non sembra
essere facilmente riadattabile per la risoluzione di altri task.\\
Si possono comunque rilevare alcune possibili migliorie in merito
all'implementazione attuale della \textit{RLPBWT}:
\begin{itemize}
  \item si potrebbe pensare ad un metodo per gestire in modo efficiente lo
  studio di più query contemporaneamente, migliorando i tempi di calcolo
  complessivi
  \item studiare eventuali ottimizzazioni per l'algoritmo di mapping e per le
  strutture dati richieste, studiando, ad esempio, se sia possibile tenere in
  memoria un solo bitvector $uv_k$ che funzioni in modo similare a quanto si era
  inizialmente pensato per la \textit{RLPBWT naive}
  \item migliorare il sistema di serializzazione. Allo stato attuale l'intera
  struttura viene serializzata e caricata in modo completo. Studiare una
  strategia efficiente per caricare, di volta in volta, in memoria solo la
  colonna necessaria ad un dato passo di computazione o comunque un sottoinsieme
  di colonne
\end{itemize}
Nonostante queste possibili migliorie la qualità dei risultati è sufficiente per
stabilire che una variante \textit{run-length encoded} della \textit{PBWT}, alla
stregua di quanto analizzato negli ultimi anni sulla \textit{RLBWT} con
\textit{MONI} \cite{moni} e \textit{PHONI} \cite{phoni}, sia possibile e possa
permettere, nel prossimo futuro, la memorizzazione compatta delle informazioni
necessarie allo studio di grandi pannelli di aplotipi. In un futuro in cui le
tecnologie di sequencing produrranno sempre più dati da sempre più individui,
avere a disposizione strutture dati efficienti dal punto di vista della
memorizzazione permetterà uno studio sempre più approfondito dei dati stessi,
nei campi dei \textit{genome-wide association studies}, della \textit{medicina
  personalizzata} etc\ldots 
% sezione sviluppi
\input{include/sviluppi}
%% BIBLIOGRAFIA
% \addcontentsline{toc}{chapter}{Bibliografia e sitografia}
% \printbibliography[title={Bibliografia e sitografia}]
%\addcontentsline{toc}{chapter}{Bibliografia}
\addcontentsline{toc}{chapter}{Riferimenti}
\bibliographystyle{unsrt}
\bibliography{thesis}

\appendix
% \chapter{Tabelle}
% \input{include/tabelle}
\chapter{Algoritmi}
\input{include/pseudo}
% \chapter{Esempi di File}
% \input{include/file}

% ringraziamenti
\input{include/ringraziamenti}
\end{document}

% LocalWords:  divergence prefix primis