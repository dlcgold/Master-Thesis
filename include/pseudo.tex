


% \begin{algorithm}
%   \scriptsize
%   \begin{algorithmic}[1]
%     \Function{build\_ms}{$col,\,\, pref,\,\, div$}
%     \State $c\gets 0,\,\,u\gets 0,\,\,v\gets 0,\,\,u'\gets 0,\,\, v'\gets
%     0,\,\,curr_{lcs}\gets 0,\,\,tmp_{thr}\gets 0,\,\,tmp_{beg}\gets 0$
%     \State $start \gets \top,\,\,beg_{run}\gets \top,\,\,push_{zero}\gets
%     \bot,\,\,push_{one}\gets \bot$
%     \For {\textit{every} $k\in\left[0,\,\, height\right)$}
%     \If{$k=0\land col[pref[k]]=1$}
%     \State $start \gets \bot$
%     \EndIf
%     \If{$col[k]=0$}
%     \State $c\gets c+1$
%     \EndIf
%     \EndFor
%     \State $runs\gets[0..0]$
%     \Comment sparse bitvector for runs of length $height+1$
%     \State $thrs\gets[0..0]$
%     \Comment sparse bitvector for thresholds of length $height$
%     \State $zeros\gets[0..0]$
%     \Comment sparse bitvector for zeros of length $c$
%     \State $ones\gets[0..0]$
%     \Comment sparse bitvector for ones of length $height-c$
%     \State $samples_{beg} \gets [],\,\,samples_{end}\gets []$
%     \Comment couple of vectors for samples of length $r$
%     \If{$start$}
%     \State $push_{one}\gets \top$
%     \Else
%     \State $push_{zero}\gets \top$
%     \EndIf
%     \For {\textit{every} $k\in\left[0,\,\, height\right)$}
%     \If{$beg_{run}$}
%     \State $u\gets u',\,\,v\gets v',\,\,tmp_{beg}\gets pref[k]$
%     \State $beg_{run}\gets \bot$
%     \EndIf
%     \If{$col[pref[k]]=1$}
%     \State $v'\gets v'+1$
%     \Else
%     \State $u'\gets u'+1$
%     \EndIf
%     \If{$k=0\lor col[pref[k]]\neq col[pref[k-1]]$}
%     \State $curr_{lcs}\gets div[k],\,\,tmp_{thr}\gets k$
%     \EndIf
%     \If{$div[k]<curr_{lcs}$}
%     \State $curr_{lcs}\gets div[k],\,\,tmp_{thr}\gets k$
%     \EndIf
%     \If{$k=height-1\lor col[pref[k]]\neq col[pref[k+1]]$}
%     \State $runs[k]\gets 1$
%     \If{$k\neq height-1\land div[k+1]<div[tmp_{thr}]$}
%     \State $thrs[k]\gets 1$
%     \Else
%     \State $thrs[tmp_{thr}]\gets 1$
%     \EndIf
%     \State $push(samples_{beg}, tmp_{beg})$
%     \State $push(samples_{end}, pref[k])$
%     \If{$push_{one}$}
%     \If{$v\neq 0$}
%     \State $ones[k-1\gets 1$
%     \EndIf
%     \State $swap(push_{zero},\,\,push_{one})$
%     \Else
%     \If{$u\neq 0$}
%     \State $zeros[k-1]\gets 1$
%     \EndIf
%     \State $swap(push_{zero},\,\,push_{one})$
%     \EndIf
%     \State $beg_{run}\gets \top$
%     \EndIf
%     \EndFor
%     \If{$|zeros|\neq 0$}
%     \State $zeros[|zeros|-1]\gets 1$
%     \EndIf
%     \If{$|ones|\neq 0$}
%     \State $ones[|ones|-1]\gets 1$
%     \EndIf
%     \State \textit{build rank/select for the four bitvectors}
%     \State \textbf{return}
%     $(start,\,\,c,\,\,runs,\,\,zeros,\,\,ones,\,\,,\,\,thr,\,\,samples_{beg},\,\,
%     samples_{end},\,\,div)$  
%     \EndFunction
%   \end{algorithmic}
%   \caption{{\footnotesize{Algoritmo per la costruzione di una colonna della
%   \textit{RLPBWT} con matching statistics}}}
%   \label{algo:cosms}
% \end{algorithm}




% \begin{algorithm}
%   \footnotesize
%   \begin{algorithmic}[1]
%     \Function{external\_matches}{$z$}
%     \Comment assuming $|z|=rlpbwt.width$
%     \State $f\gets 0,\,\,f_{run}\gets 0,\,\,f'\gets 0,\,\,e\gets 0,\,\,l\gets 0$
%     \State $g\gets 0,\,\,g_{run}\gets 0,\,\,g'\gets 0,\,\,f_{off}\gets
%     0,\,\,g_{off}\gets 0$ 
%     \For {\textit{every} $k\in\left[0,\,\, |z|\right)$}
%     \State $f_{run}\gets index\_to\_run(f,k),\,\,g_{run}\gets
%     index\_to\_run(g,k)$
%     \State $f_{off}\gets f-p_k[f_{run}],\,\,g_{off}\gets g-p_k[g_{run}]$
%     \If{$z[k]=0$}
%     \State \textbf{if} $get\_symbol(start^k, f_{run})=1$ \textbf{then}
%     $f_{off}\gets 0$
%     \State \textbf{if} $get\_symbol(start^k, g_{run})=1$ \textbf{then}
%     $g_{off}\gets 0$ 
%     \Else
%     \State \textbf{if} $get\_symbol(start^k, f_{run})=0$ \textbf{then}
%     $f_{off}\gets 0$
%     \State \textbf{if} $get\_symbol(start^k, g_{run})=0$ \textbf{then}
%     $g_{off}\gets 0$ 
%     \EndIf
%     \State $f'\gets lf\_off(k,\,\, f,\,\, z[k], f_{off}),\,\,g'\gets lf(k,\,\,
%     g,\,\, z[k], g_{off}),\,\,l\gets g-f$
%     \State \textbf{if} $f'>height$ \textbf{then} $f'\gets f'-f_{off}$
%     \State \textbf{if} $g'>height$ \textbf{then} $g'\gets g'-g_{off}$
%     \If{$f'<g'$}
%     \State $f\gets f',\,\,g\gets g'$
%     \Else
%     \If{$k\neq 0$}
%     \State \textbf{report} \textit{matches in} $[e,\,\, k-1]$ \textit{with} $l$
%     haplotypes   
%     \EndIf
%     \State \textbf{if} $f'=|lcp^{k+1}|$ \textbf{then} $e\gets k+1$ \textbf{else}
%     $e\gets k-lcp^{k+1}[f']$ 
    
%     \If{$(z[e]=0\land f'>0)\lor f'=height$}
%     \State $f'\gets g'-1$
%     \If{$e\geq 1$}
%     \State $f_{rev}\gets f',\,\,k'\gets k+1$
%     \State \textbf{while} $k'\neq e-1$ \textbf{do} $f_{rev}\gets reverse\_map(k',
%     \,\,f_{rev}),\,\,k'\gets k'-1$ 
%     \State $run\gets index\_to\_run(f_{rev},k'),\,\,symb\gets
%     get\_symbol(start^{k'}, 
%     run)$ 
%     \While {$e>0\land z[e-1]=symb$}
%     \State $f_{rev}\gets reverse\_map(e, \,\,f_{rev})$
%     \State $run\gets index\_to\_run(f_{rev}, e-1),\,\,symb\gets
%     get\_symbol(start^{e-1}, run)$ 
%     \EndWhile
%     \EndIf
%     \State \textbf{while} $f'>0\land (k+1)-lcp^{k+1}[f]\leq e$ \textbf{do}
%     $e\gets e-1$ 
%     \State $f\gets f',\,\,g\gets g'$
%     \Else
%     \State $g'\gets f'-1$
%     \If{$e\geq 1$}
%     \State $f_{rev}\gets f',\,\,k'\gets k+1$
%     \State \textbf{while} $k'\neq e-1$ \textbf{do} $f_{rev}\gets reverse\_map(k',
%     \,\,f_{rev}),\,\,k'\gets k'-1$ 
%     \State $run\gets index\_to\_run(f_{rev},k'),\,\,symb\gets
%     get\_symbol(start^{k'}, 
%     run)$ 
%     \While {$e>0\land z[e-1]=symb$}
%     \State $f_{rev}\gets reverse\_map(e, \,\,f_{rev})$
%     \State $run\gets index\_to\_run(f_{rev},e-1),\,\,symb\gets
%     get\_symbol(start^{e-1}, run)$ 
%     \EndWhile
%     \EndIf
%     \State \textbf{while} $e<height\land (k+1)-lcp^{k+1}[e]\leq e$ \textbf{do}
%     $e\gets e+1$  
%     \State $f\gets f',\,\,g\gets g'$
%     \EndIf
%     \EndIf
%     \EndFor
%     \If{$f<g$}
%     \State \textbf{report} \textit{matches in} $[e,\,\, |z|-1]$ \textit{with}
%     $l\gets g-f$ haplotypes   
%     \EndIf
%     \EndFunction
%   \end{algorithmic}
%   \caption{Algoritmo per match con aplotipo esterno con panel $width\times
%   height$ naive}
%   \label{algo:matchpanel}
% \end{algorithm}


% \begin{algorithm}
%   \footnotesize
%   \begin{algorithmic}[1]
%     \Function{external\_matches}{$z$}
%     \Comment assuming $|z|=rlpbwt.width$
%     \State $f\gets 0,\,\,f_{run}\gets 0,\,\,f'\gets 0$
%     \State $g\gets 0,\,\,g_{run}\gets 0,\,\,g'\gets 0$
%     \State $e\gets 0,\,\,l\gets 0$
%     \For {\textit{every} $k\in\left[0,\,\, |z|\right)$}
%     \State $f_{run}\gets rank_h^k(f),\,\,g_{run}\gets rank_h^k(g)$
%     \State $f'\gets lf(k,\,\, f,\,\, z[k]),\,\,g'\gets lf(k,\,\, g,\,\, z[k])$
%     \State $l\gets g-f$
%     \If{$f'<g'$}
%     \State $f\gets f',\,\,g\gets g'$
%     \Else
%     \If{$k\neq 0$}
%     \State \textbf{report} \textit{matches in} $[e,\,\, k-1]$ \textit{with} $l$
%     haplotypes   
%     \EndIf
%     \If{$f'=|lcp^{k+1}|$}
%     \State $e\gets k+1$
%     \Else
%     \State $e\gets k-lcp^{k+1}[f']$
%     \EndIf
    
%     \If{$(z[e]=0\land f'>0)\lor f'=height$}
%     \State $f'\gets g'-1$
%     \If{$e\geq 1$}
%     \State $f_{rev}\gets f',\,\,k'\gets k+1$
%     \While {$k'\neq e-1$}
%     \State $f_{rev}\gets reverse\_map(k', \,\,f_{rev}),\,\,k'\gets k'-1$
%     \EndWhile
%     \State $run\gets rank_h^{k'}(f_{rev}),\,\,symb\gets get\_symbol(start^{k'},
%     run)$ 
%     \While {$e>0\land z[e-1]=symb$}
%     \State $f_{rev}\gets reverse\_map(e, \,\,f_{rev})$
%     \State $run\gets rank_h^{e-1}(f_{rev})$
%     \State $symb\gets get\_symbol(start^{e-1}, run)$
%     \EndWhile
%     \EndIf
%     \State \textbf{while} $f'>0\land (k+1)-lcp^{k+1}[f]\leq e$ \textbf{do}
%     $e\gets e-1$ 
%     \State $f\gets f',\,\,g\gets g'$
%     \Else
%     \State $g'\gets f'-1$
%     \If{$e\geq 1$}
%     \State $f_{rev}\gets f',\,\,k'\gets k+1$
%     \While {$k'\neq e-1$}
%     \State $f_{rev}\gets reverse\_map(k', \,\,f_{rev}),\,\,k'\gets k'-1$
%     \EndWhile
%     \State $run\gets rank_h^{k'}(f_{rev}),\,\,symb\gets get\_symbol(start^{k'},
%     run)$ 
%     \While {$e>0\land z[e-1]=symb$}
%     \State $f_{rev}\gets reverse\_map(e, \,\,f_{rev})$
%     \State $run\gets rank_h^{e-1}(f_{rev})$
%     \State $symb\gets get\_symbol(start^{e-1}, run)$
%     \EndWhile
%     \EndIf
%     \State \textbf{while} $e<height\land (k+1)-lcp^{k+1}[e]\leq e$ \textbf{do}
%     $e\gets e+1$  
%     \State $f\gets f',\,\,g\gets g'$
%     \EndIf
%     \EndIf
%     \EndFor
%     \If{$f<g$}
%     \State \textbf{report} \textit{matches in} $[e,\,\, |z|-1]$ \textit{with}
%     $l\gets g-f$ haplotypes   
%     \EndIf
%     \EndFunction
%   \end{algorithmic}
%   \caption{Algoritmo per match con aplotipo esterno con panel $width\times
%   height$ con bitvectors}
%   \label{algo:matchpanelbv}
% \end{algorithm}



% \begin{algorithm}
%   \begin{algorithmic}
%     \Function {down}{$pos, prev, next$}
%     \State \textit{using LCE queries or random access check the longest common
%     prefix between $pos$ and $prev$ and between $pos$ and $next$}
%     \State \textit{if the latter is greater or equal return $\top$, else $\bot$}
%     \EndFunction
%   \end{algorithmic}
% \end{algorithm}




% \begin{algorithm}
%   \begin{algorithmic}[1]
%     \Function {$\varphi$}{$prefix_{value}, col$}
%     \State $res\gets
%     \varphi_{supp}^{prefix_{value}}[rank_{\varphi}^{prefix_{value}}(col)]$ 
%     \If{$res = panel_{height}$}
%     \State \textbf{return} $null$
%     \Else
%     \State \textbf{return} $res$
%     \EndIf
%     \EndFunction
%   \end{algorithmic}
%   \begin{algorithmic}[1]
%     \Function {$\varphi^{-1}$}{$prefix_{value}, col$}
%     \State $res\gets \varphi^{-1}_{supp}\,^{prefix_{value}}
%     [rank_{\varphi^{-1}}^{prefix_{value}}(col)]$
%     \If{$res = panel_{height}$ }
%     \State \textbf{return} $null$
%     \Else
%     \State \textbf{return} $res$
%     \EndIf
%     \EndFunction
%   \end{algorithmic}
%   \caption{Algoritmi per le query a $\varphi$ e $\varphi^{-1}$}
%   \label{algo:phiquery}
% \end{algorithm}

